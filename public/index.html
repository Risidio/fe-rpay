<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="icon" href="<%= BASE_URL %>favicon.ico">

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="rpay-pay-card.css">
    
    <!-- link to the SqPaymentForm library -->
    <script type="text/javascript" src="https://js.squareupsandbox.com/v2/paymentform"></script>
    <!-- link to the local custom styles for SqPaymentForm -->
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&display=swap" rel="stylesheet">
    <title><%= htmlWebpackPlugin.options.title %></title>
  </head>
  <body class="bg-dark">
    <noscript>You need javascript.</noscript>
    <div id="opcode"></div>
    <script>
      setTimeout(function () {
        window.eventBus.$on('rpayEvent', function (data) {
          localStorage.removeItem('OP_INVOICE')
          document.getElementById('opcode').innerHTML = data.opcode;
        })
      }, 5000);
      let risidioCardMode = 'payment-flow'
      if (location.href.indexOf('mint') > -1) {
        risidioCardMode = 'minting-flow'
      }
      let useNetwork = 'testnet'
      let risidioBaseApi = 'http://api.risidio.local'
      if (location.href.indexOf('https://trpay.risidio.com') > -1) {
        risidioBaseApi = 'https://tapi.risidio.com'
      } else if (location.href.indexOf('https://rpay.risidio.com') > -1) {
        risidioBaseApi = 'https://api.risidio.com'
        useNetwork = mainnet
      }
      const lookAndFeel = {
        variant0: 'danger',
        variant1: 'warning',
        variant2: 'info',
        variant3: 'light',
        labels: {
          title: 'Mint Your Item',
          numberUnits: 'How many items?',
          quantityLabel: 'Tokens'
        }
      }
      const payment = {
        forceNew: false,
        amountFiat: 0.5,
        currency: 'GBP',
        paymentCode: 'po-12324',
        allowMultiples: true,
        stxPaymentAddress: 'ST1R1061ZT6KPJXQ7PAXPFB6ZAZ6ZWW28G8HXK9G5',
        ethPaymentAddress: '0xe31b011344f3f03dba31eeb12308fa446165b7b4',
        paymentOption: 'fiat',
        paymentOptions: [
          { allowFiat: true },
          { allowBitcoin: true },
          { allowLightning: true },
          { allowStacks: true }, 
          { allowLSAT: false },
          { allowEthereum: true }
        ],
        creditAttributes: {
          start: 5,
          min: 2,
          max: 10,
          step: 1
        },
        squarePay: {
          applicationId: 'sandbox-sq0idb-B8CL6u-_2GdwAvkgg6M7WA',
          locationId: 'LA14YJ0CQM53A',
          squareUrl: 'squareupsandbox'
        }
      }
      const minter = {
        item: {
          assetHash: '566e0fe6379a0256466c76d47d6caa2cb0c08d8607fe61b1d9192e8b4b71f2ed',
          name: 'My Non Funginble Token',
          imageUrl: 'https://images.prismic.io/risidio-journal/5757dd30-d293-4586-a99b-bdce237f7a69_alexander-sinn-KgLtFCgfC28-unsplash.png?auto=compress,format'
        },
        preferredNetwork: 'stacks connect',
        networks: [
          {
            network: 'stacks risidio',
            functionName: 'mint-token',
            contractAddress: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW',
            contractName: 'loopbomb'
          },
          {
            network: 'stacks connect',
            functionName: 'mint-token',
            contractAddress: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW',
            contractName: 'loopbomb'
          },
          {
            network: 'ethereum',
            functionName: 'mint-token',
            contractAddress: '0xD32311b42F0F4B592A2a388F90725f4af686C51b'
          }
        ],
        beneficiaries: [
          {
            username: 'albert.einstein.id',
            role: 'owner',
            email: 'owner@somewhere.com',
            royalty: 3,
            chainAddress: 'ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW',
          }
        ]
      }
      const configuration = {
        lookAndFeel: lookAndFeel,
        payment: payment,
        minter: minter,
        network: useNetwork,
        risidioBaseApi: risidioBaseApi,
        risidioStacksApi: 'http://localhost:20443',
        risidioWalletMac: '{"label": "MacMock", "mnemonic": "","keyInfo": {"privateKey": "4790db90a48e51bdbbc62a37fdc535719c22e195dc1aa6e1725b30bffc569ce501","address": "ST1ESYCGJB5Z5NBHS39XPC70PGC14WAQK5XXNQYDW","btcAddress": "","index": 0}}',
        risidioCardMode: risidioCardMode
      }
      window.risidioPaymentConfig = JSON.stringify(configuration)
    </script>
    <div id="risidio-pay" msg="aint no sunshine!"></div>
  </body>
</html>
